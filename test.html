<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Oracle Imp√¥t</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #f8fafc; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .test-container { width: 100%; max-width: 500px; padding: 20px; }
        .card { background: white; padding: 40px; border-radius: 24px; box-shadow: 0 20px 40px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        .progress-wrap { margin-bottom: 30px; text-align: center; }
        .bar-bg { background: #e2e8f0; height: 8px; border-radius: 10px; overflow: hidden; margin-bottom: 10px; }
        .bar-fill { background: linear-gradient(90deg, #2563eb, #3b82f6); height: 100%; width: 0%; transition: 0.4s; }
        .progress-txt { color: #2563eb; font-weight: 800; font-size: 14px; }
        .title { font-size: 22px; font-weight: 800; color: #0f172a; margin-bottom: 25px; }
        .btn-choice { display: block; width: 100%; padding: 16px; margin-bottom: 10px; border: 2px solid #e2e8f0; border-radius: 12px; background: white; font-weight: 600; cursor: pointer; text-align: left; transition: 0.2s; }
        .btn-choice:hover { border-color: #2563eb; background: #f0f7ff; }
        input { width: 100%; padding: 16px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; margin-bottom: 20px; box-sizing: border-box; outline: none; }
        input:focus { border-color: #2563eb; }
        .btn-next { width: 100%; padding: 16px; background: #2563eb; color: white; border: none; border-radius: 12px; font-weight: 800; font-size: 16px; cursor: pointer; }
        .btn-next:disabled { opacity: 0.3; cursor: not-allowed; }
        .security-note { font-size: 12px; color: #64748b; margin-bottom: 20px; display: flex; align-items: center; gap: 6px; justify-content: center; }
        .rgpd { font-size: 11px; color: #94a3b8; margin-top: 15px; line-height: 1.4; }
    </style>
</head>
<body>

<div class="test-container">
    <div class="progress-wrap">
        <div class="bar-bg"><div class="bar-fill" id="bar"></div></div>
        <div class="progress-txt" id="stepTxt">Chargement...</div>
    </div>

    <div class="card" id="box">
        <!-- Inject√© par JS -->
    </div>
</div>

<script>
    const questions = [
        { id: 'situation', t: 'Quelle est votre situation ?', type: 'choice', opts: ['Salari√©', 'Ind√©pendant', 'Chef d\'entreprise', 'Retrait√©', '√âtudiant', 'Sans activit√©'] },
        { id: 'age', t: 'Quel √¢ge avez-vous ?', type: 'input', it: 'number', p: 'Ex: 35' },
        { id: 'enfants', t: 'Combien d\'enfants √† charge ?', type: 'choice', opts: ['0', '1', '2', '3', '4+'] },
        { id: 'logement', t: 'Comment logez-vous ?', type: 'choice', opts: ['Propri√©taire', 'Locataire', 'Log√© gratuitement'] },
        { id: 'activite', t: 'Quelle est votre activit√© ?', type: 'input', it: 'text', p: 'Ex: Ing√©nieur...' },
        { id: 'revenus', t: 'Revenus nets MENSUELS ?', type: 'input', it: 'number', p: 'Ex: 3000' },
        { id: 'contact', t: 'Votre r√©sultat est pr√™t !', type: 'contact' }
    ];

    let step = 0;
    let data = {};

    function show() {
        const box = document.getElementById('box');
        const q = questions[step];
        
        document.getElementById('bar').style.width = ((step + 1) / questions.length * 100) + '%';
        document.getElementById('stepTxt').innerText = "Question " + (step + 1) + " sur " + questions.length;

        let html = `<div class="title">${q.t}</div>`;

        if (q.type === 'choice') {
            q.opts.forEach(o => {
                html += `<button class="btn-choice" onclick="save('${o}')">${o}</button>`;
            });
        } else if (q.type === 'input') {
            html += `<input type="${q.it}" id="ans" placeholder="${q.p}" oninput="check()">`;
            html += `<button class="btn-next" id="nxt" onclick="go()" disabled>Suivant</button>`;
        } else {
            html += `
                <input type="text" id="nom" placeholder="Nom Pr√©nom">
                <input type="email" id="email" placeholder="Email">
                <input type="tel" id="tel" placeholder="T√©l√©phone">
                <div class="security-note">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                    Vous allez recevoir un code de v√©rification par SMS.
                </div>
                <button class="btn-next" onclick="send()">Recevoir mon analyse</button>
                <div class="rgpd">En validant, vous acceptez d'√™tre recontact√© par un conseiller Oracle Imp√¥t conform√©ment √† notre politique de confidentialit√©.</div>
            `;
        }
        box.innerHTML = html;
        if(document.getElementById('ans')) document.getElementById('ans').focus();
    }

    window.save = (v) => { 
        data[questions[step].id] = v; 
        if(step === 0 && v === '√âtudiant') {
            document.getElementById('box').innerHTML = "<h2>D√©sol√©</h2><p>Ce test est r√©serv√© aux actifs et retrait√©s.</p><br><button class='btn-next' onclick='location.reload()'>Recommencer</button>";
            return;
        }
        step++;
        show(); 
    };

    window.check = () => { 
        const val = document.getElementById('ans').value;
        document.getElementById('nxt').disabled = val.length < 1; 
    };

    window.go = () => { 
        // CAPTURE DE LA R√âPONSE INPUT
        if(document.getElementById('ans')) {
            data[questions[step].id] = document.getElementById('ans').value;
        }
        step++; 
        show(); 
    };

    window.send = () => {
        const email = document.getElementById('email').value;
        const nom = document.getElementById('nom').value;
        const tel = document.getElementById('tel').value;

        if(!email || !nom || !tel) { 
            alert('Veuillez remplir tous les champs'); 
            return; 
        }

        // CONSTRUCTION DU MESSAGE COMPLET
        const finalMsg = `
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üîî NOUVEAU LEAD ORACLE IMP√îT
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üë§ CONTACT:
   Nom: ${nom}
   Email: ${email}
   T√©l√©phone: ${tel}

üìã PROFIL FISCAL:
   ‚Ä¢ Situation: ${data.situation || 'Non renseign√©'}
   ‚Ä¢ √Çge: ${data.age || 'Non renseign√©'} ans
   ‚Ä¢ Enfants √† charge: ${data.enfants || 'Non renseign√©'}
   ‚Ä¢ Logement: ${data.logement || 'Non renseign√©'}
   ‚Ä¢ Activit√©: ${data.activite || 'Non renseign√©'}
   ‚Ä¢ Revenus nets mensuels: ${data.revenus || 'Non renseign√©'}‚Ç¨

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
        `.trim();

        // ENVOI FORMSPREE
        const formData = new FormData();
        formData.append('email', email);
        formData.append('nom', nom);
        formData.append('telephone', tel);
        formData.append('message', finalMsg);

        fetch('https://formspree.io/f/xeezykeq', {
            method: 'POST',
            body: formData,
            headers: { 'Accept': 'application/json' }
        })
        .then(response => {
            if(response.ok) {
                document.getElementById('box').innerHTML = `
                    <div style='text-align:center'>
                        <h2 style='color:#2563eb'>‚úÖ C'est envoy√© !</h2>
                        <p>Un conseiller vous contactera tr√®s prochainement avec votre analyse personnalis√©e.</p>
                        <button class='btn-next' onclick='location.href="index.html"' style='margin-top:20px'>Retour √† l'accueil</button>
                    </div>
                `;
            } else {
                alert('Erreur lors de l\'envoi. Veuillez r√©essayer.');
            }
        })
        .catch(() => {
            alert('Erreur r√©seau. V√©rifiez votre connexion.');
        });
    };

    // LANCEMENT
    show();
</script>

</body>
</html>
